mood<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Penghitung Kalori & Protein Harian</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="bg-gradient-to-b from-gray-100 to-gray-200 text-gray-900 min-h-screen">
  <div class="max-w-4xl mx-auto mt-8 bg-white p-6 rounded-2xl card fade-in">
    <h1 class="text-2xl font-bold text-center mb-6 text-blue-700">üç± Penghitung Kalori & Protein Harian</h1>

    <!-- Data Pengguna -->
    <section class="border-b pb-4 mb-5">
      <h2 class="text-lg font-semibold mb-3">üìã Data Pengguna</h2>
      <div class="grid grid-cols-2 gap-3">
        <select id="gender" class="border p-2 rounded">
          <option value="">Jenis Kelamin</option>
          <option value="pria">Pria</option>
          <option value="wanita">Wanita</option>
        </select>
        <input id="age" type="number" placeholder="Usia (tahun)" class="border p-2 rounded">
        <input id="weight" type="number" placeholder="Berat (kg)" class="border p-2 rounded">
        <input id="height" type="number" placeholder="Tinggi (cm)" class="border p-2 rounded">
      </div>

      <div class="mt-3">
        <select id="activity" class="border rounded w-full p-2 mb-2">
          <option value="">Pilih Aktivitas</option>
          <option value="1.2">Sangat ringan</option>
          <option value="1.375">Ringan (1‚Äì3x/minggu)</option>
          <option value="1.55">Sedang (3‚Äì5x/minggu)</option>
          <option value="1.725">Berat (6‚Äì7x/minggu)</option>
          <option value="1.9">Sangat berat</option>
        </select>
        <select id="goal" class="border rounded w-full p-2">
          <option value="">Pilih Tujuan</option>
          <option value="defisit">Defisit (turun berat)</option>
          <option value="maintenance">Stabil (maintenance)</option>
          <option value="surplus">Surplus (naik berat)</option>
        </select>
      </div>

      <button id="calcBtn" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded w-full font-semibold">Hitung Kebutuhan Harian</button>

      <div class="text-center mt-3 font-semibold text-blue-700">
        <p id="dailyNeed"></p>
        <p id="proteinNeed"></p>
      </div>
    </section>

    <!-- Input makanan -->
    <section>
      <h2 class="text-lg font-semibold mb-2">ü•ó Input Makanan</h2>
      <div class="flex gap-2 mb-3">
        <input id="foodName" type="text" placeholder="Nama makanan (misal: nasi goreng)" class="flex-1 border rounded p-2">
        <input id="foodGram" type="number" placeholder="Gram" class="w-24 border rounded p-2">
        <button id="addBtn" class="bg-green-600 hover:bg-green-700 text-white px-4 rounded font-semibold">+</button>
      </div>

      <ul id="foodList" class="space-y-1 text-sm list-disc list-inside"></ul>

      <div class="text-center mt-4">
        <p class="text-lg font-semibold">Total Kalori: <span id="totalCalories" class="text-blue-700">0</span> kcal</p>
        <p class="text-lg font-semibold">Total Protein: <span id="totalProtein" class="text-green-700">0</span> g</p>
        <p id="status" class="mt-2 text-sm font-semibold"></p>
        <button id="resetBtn" class="mt-3 bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded text-sm">Reset Semua</button>
      </div>
    </section>

    <!-- Grafik progres -->
    <section class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <h2 class="text-lg font-semibold mb-2">üìä Grafik Kalori</h2>
        <canvas id="calorieChart" height="100"></canvas>
      </div>
      <div>
        <h2 class="text-lg font-semibold mb-2">üí™ Grafik Protein</h2>
        <canvas id="proteinChart" height="100"></canvas>
      </div>
    </section>
  </div>

  <script src="assets/js/app.js"></script>
</body>
</html>

/* Minimal custom styles: card shadow and simple animations */
body { font-family: 'Inter', sans-serif; }
.card { box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
.fade-in { animation: fadeIn .45s ease-in; }
@keyframes fadeIn { from {opacity:0;} to {opacity:1;} }

/* small responsive tweaks */
@media (max-width: 640px) {
  .container { padding: 16px; }
} // app.js - logic separated for GitHub Pages deployment

// Expanded food database (~100 items) with realistic per-100g values (calories & protein)
const foodDB = {
  "nasi putih": { cal: 130, protein: 2.7 }, "nasi goreng": { cal: 180, protein: 4.5 },
  "nasi uduk": { cal: 250, protein: 4 }, "nasi kuning": { cal: 240, protein: 4 },
  "nasi padang": { cal: 260, protein: 6 }, "nasi bakar": { cal: 210, protein: 5 },
  "ayam goreng": { cal: 260, protein: 28 }, "ayam bakar": { cal: 195, protein: 29 },
  "ayam rebus": { cal: 165, protein: 31 }, "ayam geprek": { cal: 280, protein: 27 },
  "dada ayam": { cal: 165, protein: 31 }, "paha ayam": { cal: 210, protein: 25 },
  "ikan tongkol": { cal: 132, protein: 28 }, "ikan tuna": { cal: 132, protein: 28 },
  "ikan salmon": { cal: 208, protein: 20 }, "ikan lele": { cal: 180, protein: 20 },
  "ikan nila": { cal: 100, protein: 20 }, "udang": { cal: 99, protein: 24 },
  "cumi": { cal: 92, protein: 15 }, "kepiting": { cal: 83, protein: 19 },
  "tahu goreng": { cal: 190, protein: 8 }, "tahu kukus": { cal: 76, protein: 8 },
  "tempe goreng": { cal: 200, protein: 11 }, "tempe bacem": { cal: 170, protein: 10 },
  "telur rebus": { cal: 155, protein: 13 }, "telur mata sapi": { cal: 196, protein: 13 },
  "telur dadar": { cal: 200, protein: 12 }, "sate ayam": { cal: 160, protein: 14 },
  "sate kambing": { cal: 200, protein: 18 }, "rendang": { cal: 195, protein: 18 },
  "rawon": { cal: 150, protein: 11 }, "gado-gado": { cal: 180, protein: 8 },
  "ketoprak": { cal: 180, protein: 7 }, "soto ayam": { cal: 120, protein: 9 },
  "soto daging": { cal: 140, protein: 12 }, "bakso sapi": { cal: 180, protein: 9 },
  "bakso ayam": { cal: 150, protein: 10 }, "mie goreng": { cal: 330, protein: 8 },
  "mie rebus": { cal: 280, protein: 7 }, "bakmi": { cal: 300, protein: 10 },
  "kwetiau": { cal: 290, protein: 9 }, "bihun goreng": { cal: 320, protein: 7 },
  "capcay": { cal: 90, protein: 3 }, "sayur asem": { cal: 40, protein: 1.5 },
  "sayur lodeh": { cal: 80, protein: 2 }, "sayur bayam": { cal: 23, protein: 2.9 },
  "tumis kangkung": { cal: 70, protein: 3 }, "tempe orek": { cal: 210, protein: 11 },
  "sop buntut": { cal: 220, protein: 18 }, "nugget ayam": { cal: 290, protein: 12 },
  "burger (daging)": { cal: 295, protein: 17 }, "kentang goreng": { cal: 312, protein: 3.4 },
  "pizza (keju)": { cal: 266, protein: 11 }, "spaghetti": { cal: 158, protein: 5 },
  "roti tawar": { cal: 265, protein: 9 }, "roti isi": { cal: 300, protein: 8 },
  "roti bakar": { cal: 320, protein: 8 }, "bubur ayam": { cal: 120, protein: 7 },
  "lontong": { cal: 100, protein: 2 }, "ketupat": { cal: 96, protein: 2 },
  "sate padang": { cal: 210, protein: 17 }, "pempek": { cal: 220, protein: 11 },
  "siomay": { cal: 120, protein: 10 }, "bakwan": { cal: 150, protein: 3 },
  "pisang goreng": { cal: 260, protein: 3.5 }, "pisang": { cal: 89, protein: 1.1 },
  "apel": { cal: 52, protein: 0.3 }, "jeruk": { cal: 47, protein: 0.9 },
  "alpukat": { cal: 160, protein: 2 }, "mangga": { cal: 60, protein: 0.8 },
  "semangka": { cal: 30, protein: 0.6 }, "melon": { cal: 34, protein: 0.8 },
  "kacang tanah": { cal: 567, protein: 26 }, "kacang mede": { cal: 553, protein: 18 },
  "kacang kedelai": { cal: 446, protein: 36 }, "kacang hijau": { cal: 347, protein: 23 },
  "susu sapi": { cal: 60, protein: 3.2 }, "yoghurt": { cal: 59, protein: 10 },
  "keju": { cal: 350, protein: 25 }, "es teh manis": { cal: 60, protein: 0 },
  "kopi (hitam)": { cal: 2, protein: 0.3 }, "kopi susu": { cal: 50, protein: 1.5 },
  "teh pahit": { cal: 1, protein: 0 }, "air kelapa": { cal: 19, protein: 0.7 },
  "susu kental manis": { cal: 321, protein: 7.6 }, "kue bolu": { cal: 350, protein: 6 },
  "dadar gulung": { cal: 210, protein: 4 }, "klepon": { cal: 220, protein: 1.5 },
  "onde-onde": { cal: 260, protein: 4 }, "risoles": { cal: 280, protein: 6 },
  "lokum (sekoteng)": { cal: 120, protein: 2 }, "tempe mendoan": { cal: 210, protein: 11 },
  "sop iga": { cal: 240, protein: 20 }, "ayam betutu": { cal: 230, protein: 24 },
  "coto makassar": { cal: 200, protein: 13 }, "soto mie": { cal: 250, protein: 10 }
};

// State - synced with localStorage
let totalCalories = +localStorage.getItem('totalCalories') || 0;
let totalProtein = +localStorage.getItem('totalProtein') || 0;
let dailyNeed = +localStorage.getItem('dailyNeed') || 0;
let proteinNeed = +localStorage.getItem('proteinNeed') || 0;
let foodList = JSON.parse(localStorage.getItem('foodList')) || [];
let history = JSON.parse(localStorage.getItem('history')) || [];

const el = id => document.getElementById(id);
let calorieChart, proteinChart;

// Init
window.addEventListener('load', () => {
  renderList();
  updateDisplay();
  initCharts();
  // attach events
  el('addBtn').addEventListener('click', addFood);
  el('calcBtn').addEventListener('click', calculateNeeds);
  el('resetBtn').addEventListener('click', resetAll);
});

function calculateNeeds() {
  const g = el('gender').value;
  const a = +el('age').value; const w = +el('weight').value; const h = +el('height').value;
  const act = +el('activity').value; const goal = el('goal').value;
  if (!g || !a || !w || !h || !act || !goal) return alert('Lengkapi semua data!');

  const bmr = g === 'pria'
    ? 88.362 + (13.397 * w) + (4.799 * h) - (5.677 * a)
    : 447.593 + (9.247 * w) + (3.098 * h) - (4.330 * a);

  let tdee = bmr * act;
  if (goal === 'defisit') tdee -= 500;
  if (goal === 'surplus') tdee += 500;

  dailyNeed = Math.round(tdee);
  proteinNeed = Math.round(w * 1.6);
  localStorage.setItem('dailyNeed', dailyNeed);
  localStorage.setItem('proteinNeed', proteinNeed);
  updateDisplay();
}

function addFood() {
  const name = el('foodName').value.toLowerCase().trim();
  const gram = +el('foodGram').value; if (!name || !gram || gram <= 0) return alert('Masukkan nama & gram valid!');
  if (!foodDB[name]) return alert('Makanan tidak ada di database! Coba ejaan yang lain.');

  const cal = (foodDB[name].cal / 100) * gram;
  const pro = (foodDB[name].protein / 100) * gram;
  totalCalories += cal; totalProtein += pro; foodList.push({ name, gram, cal, pro });
  saveData(); renderList(); updateDisplay(); updateCharts();
  el('foodName').value = ''; el('foodGram').value = '';
}

function renderList() {
  el('foodList').innerHTML = foodList.map(f =>
    `<li>${capitalize(f.name)} - ${f.gram}g = ${f.cal.toFixed(1)} kcal / ${f.pro.toFixed(1)} g protein</li>`
  ).join('');
}

function updateDisplay() {
  el('totalCalories').textContent = totalCalories.toFixed(1);
  el('totalProtein').textContent = totalProtein.toFixed(1);
  el('dailyNeed').textContent = dailyNeed ? `Kebutuhan kalori: ${dailyNeed} kcal` : '';
  el('proteinNeed').textContent = proteinNeed ? `Kebutuhan protein: ${proteinNeed} g` : '';
  const diff = totalCalories - dailyNeed;
  el('status').textContent = !dailyNeed ? '' : diff < -100 ? 'üî• Masih defisit kalori.' : diff > 100 ? '‚ö†Ô∏è Surplus kalori.' : '‚úÖ Kalori seimbang.';
}

function saveData() {
  localStorage.setItem('foodList', JSON.stringify(foodList));
  localStorage.setItem('totalCalories', totalCalories);
  localStorage.setItem('totalProtein', totalProtein);
}

function resetAll() {
  if (!confirm('Yakin reset semua data?')) return; totalCalories = 0; totalProtein = 0; dailyNeed = 0; proteinNeed = 0; foodList = []; history = []; localStorage.clear(); renderList(); updateDisplay(); updateCharts(true);
}

function initCharts() {
  const today = new Date().toLocaleDateString();
  const last = history[history.length - 1];
  if (!last || last.date !== today) history.push({ date: today, calories: totalCalories, protein: totalProtein });

  const ctxC = el('calorieChart').getContext('2d');
  calorieChart = new Chart(ctxC, { type: 'line', data: { labels: history.map(d=>d.date), datasets: [{ label: 'Kalori', data: history.map(d=>d.calories), borderColor: '#2563eb', backgroundColor: 'rgba(37,99,235,0.2)', fill: true, tension: 0.3 }]}, options: { responsive: true, scales: { y: { beginAtZero: true } } } });

  const ctxP = el('proteinChart').getContext('2d');
  proteinChart = new Chart(ctxP, { type: 'line', data: { labels: history.map(d=>d.date), datasets: [{ label: 'Protein (g)', data: history.map(d=>d.protein), borderColor: '#16a34a', backgroundColor: 'rgba(22,163,74,0.2)', fill: true, tension: 0.3 }]}, options: { responsive: true, scales: { y: { beginAtZero: true } } } });
}

function updateCharts(reset=false) {
  const today = new Date().toLocaleDateString();
  if (reset) history = []; else { const idx = history.findIndex(d=>d.date===today); if (idx>=0) history[idx] = { date: today, calories: totalCalories, protein: totalProtein }; else history.push({ date: today, calories: totalCalories, protein: totalProtein }); }
  localStorage.setItem('history', JSON.stringify(history));
  if (calorieChart && proteinChart) { calorieChart.data.labels = history.map(d=>d.date); calorieChart.data.datasets[0].data = history.map(d=>d.calories); proteinChart.data.labels = history.map(d=>d.date); proteinChart.data.datasets[0].data = history.map(d=>d.protein); calorieChart.update(); proteinChart.update(); }
}

const capitalize = s => s.charAt(0).toUpperCase() + s.slice(1);
